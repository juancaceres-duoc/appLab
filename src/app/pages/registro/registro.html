<div class="auth-card registro-card">
    <h2 class="auth-title">Registro de usuario</h2>
    <p class="auth-subtitle">
        Crea una cuenta para acceder al sistema de laboratorio.
    </p>

    <form [formGroup]="registroForm" (ngSubmit)="onSubmit()">

        <div class="form-field">
            <label class="form-label" for="nombre">Nombre completo</label>
            <input id="nombre" type="text" class="form-input" formControlName="nombre" placeholder="Ej: Juan Pérez" />

            <div *ngIf="nombre?.touched && nombre?.invalid" class="error-text">
                <span *ngIf="nombre?.errors?.['required']">El nombre es obligatorio.</span>
                <span *ngIf="nombre?.errors?.['minlength']">Debe tener al menos 2 caracteres.</span>
            </div>
        </div>

        <div class="form-field">
            <label class="form-label" for="rut">RUT</label>
            <input id="rut" type="text" class="form-input" formControlName="rut" placeholder="Ej: 12.345.678-9" />

            <div *ngIf="rut?.touched && rut?.invalid" class="error-text">
                <span *ngIf="rut?.errors?.['required']">El RUT es obligatorio.</span>
            </div>
        </div>

        <div class="form-field">
            <label class="form-label" for="email">Correo electrónico</label>
            <input id="email" type="email" class="form-input" formControlName="email"
                placeholder="ejemplo@laboratorio.cl" />

            <div *ngIf="email?.touched && email?.invalid" class="error-text">
                <span *ngIf="email?.errors?.['required']">El correo es obligatorio.</span>
                <span *ngIf="email?.errors?.['email']">Debe ser un correo válido.</span>
            </div>
        </div>

        <div class="form-field">
            <label class="form-label" for="password">Contraseña</label>

            <div class="password-box">
                <input id="password" [type]="passwordVisible ? 'text' : 'password'" class="form-input"
                    formControlName="password" placeholder="Contraseña segura" />
                <button type="button" class="toggle-pass-btn" (click)="togglePasswordVisibility()">
                    {{ passwordVisible ? 'Ocultar' : 'Ver' }}
                </button>
            </div>

            <div *ngIf="password?.touched && password?.invalid" class="error-text">
                <span *ngIf="password?.errors?.['required']">La contraseña es obligatoria.</span>
                <span *ngIf="password?.errors?.['minlength']">Debe tener al menos 8 caracteres.</span>
                <span *ngIf="password?.errors?.['maxlength']">No puede tener más de 20 caracteres.</span>
                <span *ngIf="password?.errors?.['pattern']">Debe incluir mayúsculas, minúsculas y números.</span>
            </div>
        </div>

        <div class="form-field">
            <label class="form-label" for="confirmPassword">Confirmar contraseña</label>

            <div class="password-box">
                <input id="confirmPassword" [type]="confirmPasswordVisible ? 'text' : 'password'" class="form-input"
                    formControlName="confirmPassword" placeholder="Repite la contraseña" />
                <button type="button" class="toggle-pass-btn" (click)="toggleConfirmPasswordVisibility()">
                    {{ confirmPasswordVisible ? 'Ocultar' : 'Ver' }}
                </button>
            </div>

            <div *ngIf="confirmPassword?.touched && confirmPassword?.invalid" class="error-text">
                <span *ngIf="confirmPassword?.errors?.['required']">Debes confirmar la contraseña.</span>
            </div>

            <div *ngIf="registroForm.touched && registroForm.errors?.['passwordsNoCoinciden']" class="error-text">
                Las contraseñas no coinciden.
            </div>
        </div>

        <div *ngIf="mensajeExito" class="msg-exito">{{ mensajeExito }}</div>
        <div *ngIf="mensajeError" class="msg-error">{{ mensajeError }}</div>

        <button type="submit" class="btn-primary" [disabled]="registroForm.invalid">
            Crear cuenta
        </button>
    </form>
</div>